<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale-1.0">
    <title>Our Teas - Nandana Tea</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>

    <header>
        <a href="index.html" class="logo"><i class="fa-solid fa-leaf"></i> Nandana Tea</a>
       <nav>
            <a href="index.html">Home</a>
            <a href="products.html">Products</a>
            <a href="about.html">About Us</a>
            <a href="contact.html">Contact</a>
        </nav>
        <div class="header-icons">
            <a href="#"><i class="fa-solid fa-cart-shopping"></i> Cart</a>
            <a href="#" id="search-icon" title="Search"><i class="fa-solid fa-magnifying-glass"></i></a>
        </div>
        <div class="hamburger-menu">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </div>
    </header>

    <main class="container">
        <section class="page-header">
            <h1>Our Teas</h1>
        </section>

        <div class="product-controls">
            <a href="#" class="btn active">Retail</a>
            <a href="wholesale.html" class="btn">Wholesale</a>
        </div>
        
        <div class="product-grid" id="product-grid">
            <!-- Populated from localStorage nandana_products by script -->
        </div>
    </main>

    <footer>
        <div class="container footer-content">
            <p>Â© 2025 Nandana Tea Factory. All rights reserved.</p>
            <div class="footer-links">
                <a href="#">Privacy Policy</a>
                <a href="#">Terms of Service</a>
                <a href="contact.html">Contact Us</a>
            </div>
        </div>
    </footer>

    <div id="search-modal" class="search-modal">
        <div class="search-modal-content">
            <span id="close-search" class="close-search">&times;</span>
            <input type="text" id="search-input" placeholder="Search teas..." autofocus>
            <div id="search-results" class="search-results"></div>
        </div>
    </div>

    <script src="main.js"></script>
    <script>
    // Build PRODUCTS map from `nandana_products` for search and let ProductSystem.render() draw the grid.
    function buildSearchIndex() {
        const stored = JSON.parse(localStorage.getItem('nandana_products') || '[]');
        const defaults = [
            { id: 'black-tea', name: 'Nandana Black Tea', price: 12.00, image: 'srs/black tea.jpg' },
            { id: 'green-tea', name: 'Nandana Green Tea', price: 14.00, image: 'srs/green tea.png' },
            { id: 'white-tea', name: 'Nandana White Tea', price: 18.00, image: 'srs/white tea.png' },
            { id: 'oolong-tea', name: 'Nandana Oolong Tea', price: 16.00, image: 'srs/oolong tea.png' },
            { id: 'almond-tea', name: 'Nandana Almond Tea', price: 17.00, image: 'srs/ahmad tea.png' },
            { id: 'cinnamon-tea', name: 'Nandana Cinnamon Tea', price: 19.00, image: 'srs/cinnamon tea.jpg' }
        ];
        const products = (stored && stored.length) ? stored : defaults;
        window.PRODUCTS = {};
        products.forEach(p => { window.PRODUCTS[p.id] = { name: p.name, price: parseFloat(p.price)||0, image: p.img||p.image||'' }; });
    }

    // Search functionality wired to dynamic PRODUCTS map
    document.addEventListener('DOMContentLoaded', () => {
        // Ensure search index reflects inventory, then render grid via ProductSystem
        buildSearchIndex();
        try { if (window.ProductSystem && typeof window.ProductSystem.render === 'function') window.ProductSystem.render(); } catch(e) { /* ignore */ }

        const searchIcon = document.getElementById('search-icon');
        const searchModal = document.getElementById('search-modal');
        const closeSearch = document.getElementById('close-search');
        const searchInput = document.getElementById('search-input');
        const searchResults = document.getElementById('search-results');

        if (searchIcon) searchIcon.addEventListener('click', (e) => { e.preventDefault(); searchModal.style.display = 'flex'; searchInput.focus(); });
        if (closeSearch) closeSearch.addEventListener('click', () => { searchModal.style.display = 'none'; searchInput.value = ''; searchResults.innerHTML = ''; });
        if (searchModal) searchModal.addEventListener('click', (e) => { if (e.target === searchModal) searchModal.style.display = 'none'; });

        if (searchInput) {
            searchInput.addEventListener('input', (e) => {
                const q = e.target.value.toLowerCase().trim();
                if (!q) { searchResults.innerHTML = ''; return; }
                const matches = Object.entries(window.PRODUCTS || {}).filter(([id, p]) => p.name.toLowerCase().includes(q) || id.includes(q));
                searchResults.innerHTML = matches.map(([id, p]) => `
                    <div class="search-result-item">
                        <img src="${p.image}" alt="${p.name}" class="search-result-img">
                        <div style="flex:1;">
                            <a href="product.html?id=${id}" onclick="document.getElementById('search-modal').style.display='none';">${p.name}</a>
                            <span class="price">$${(p.price||0).toFixed(2)}</span>
                        </div>
                    </div>
                `).join('') || '<p class="empty-msg">No products found</p>';
            });

            searchInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') { const firstLink = searchResults.querySelector('a'); if (firstLink) firstLink.click(); } });
        }
    });
    </script>
</body>
</html>