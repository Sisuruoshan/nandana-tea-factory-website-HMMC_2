// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id                String    @id @default(auto()) @map("_id") @db.ObjectId
  name              String
  email             String    @unique
  emailVerifiedAt   DateTime? @map("email_verified_at")
  password          String
  phone             String?
  address           String?
  avatar            String?
  rememberToken     String?   @map("remember_token")
  createdAt         DateTime  @default(now()) @map("created_at")
  updatedAt         DateTime  @updatedAt @map("updated_at")
  orders            Order[]

  @@map("users")
}

model UserSignup {
  id        String    @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  email     String    @unique
  password  String
  phone     String?
  address   String?
  avatar    String?
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @updatedAt @map("updated_at")
  carts     Cart[]

  @@map("user_signups")
}

model Product {
  id              String     @id @default(auto()) @map("_id") @db.ObjectId
  name            String
  description     String
  slug            String     @unique
  price           Float
  wholesalePrice  Float?     @map("wholesale_price")
  image           String?
  image2          String?    @map("image_2")
  origin          String?
  notes           String?
  brewingGuide    String?    @map("brewing_guide")
  longDescription String?    @map("long_description")
  stock           Int        @default(0)
  isWholesale     Boolean    @default(false) @map("is_wholesale")
  createdAt       DateTime   @default(now()) @map("created_at")
  updatedAt       DateTime   @updatedAt @map("updated_at")
  cartItems       CartItem[]

  @@map("products")
}

model Cart {
  id         String     @id @default(auto()) @map("_id") @db.ObjectId
  userId     String     @map("user_id") @db.ObjectId
  totalAmount Float     @default(0) @map("total_amount")
  createdAt  DateTime   @default(now()) @map("created_at")
  updatedAt  DateTime   @updatedAt @map("updated_at")
  user       UserSignup @relation(fields: [userId], references: [id], onDelete: Cascade)
  items      CartItem[]

  @@map("carts")
}

model CartItem {
  id        String    @id @default(auto()) @map("_id") @db.ObjectId
  cartId    String    @map("cart_id") @db.ObjectId
  productId String    @map("product_id") @db.ObjectId
  quantity  Int       @default(1)
  price     Float
  subtotal  Float
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @updatedAt @map("updated_at")
  cart      Cart      @relation(fields: [cartId], references: [id], onDelete: Cascade)
  product   Product   @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("cart_items")
}

model Inquiry {
  id        String    @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  email     String
  subject   String
  message   String
  status    String    @default("new")
  reply     String?
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime  @updatedAt @map("updated_at")

  @@map("inquiries")
}

model WholesaleInquiry {
  id         String    @id @default(auto()) @map("_id") @db.ObjectId
  name       String
  company    String
  email      String
  phone      String?
  address    String?
  details    String
  status     String    @default("new")
  adminNotes String?   @map("admin_notes")
  reply      String?
  createdAt  DateTime  @default(now()) @map("created_at")
  updatedAt  DateTime  @updatedAt @map("updated_at")

  @@map("wholesale_inquiries")
}

model Order {
  id             String    @id @default(auto()) @map("_id") @db.ObjectId
  userId         String?   @map("user_id") @db.ObjectId
  customerName   String    @map("customer_name")
  customerEmail  String    @map("customer_email")
  customerPhone  String?   @map("customer_phone")
  shippingAddress String?  @map("shipping_address")
  totalPrice     Float     @map("total_price")
  status         String    @default("pending")
  notes          String?
  createdAt      DateTime  @default(now()) @map("created_at")
  updatedAt      DateTime  @updatedAt @map("updated_at")
  user           User?     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("orders")
}

model Session {
  id           String   @id @map("_id")
  userId       String?  @map("user_id") @db.ObjectId
  ipAddress    String?  @map("ip_address")
  userAgent    String?  @map("user_agent")
  payload      String
  lastActivity Int      @map("last_activity")

  @@map("sessions")
}

model PasswordResetToken {
  email     String   @id @map("_id")
  token     String
  createdAt DateTime? @map("created_at")

  @@map("password_reset_tokens")
}
